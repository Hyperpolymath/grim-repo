= Getting Your Repositories Under Control
:toc:
:toc-title: Contents

== The Problem

You have hundreds of repositories. Some are:
- âŒ Missing LICENSE files
- âŒ No SECURITY.md
- âŒ No contribution guidelines
- âŒ Inconsistent quality standards
- âŒ Hard to maintain at scale

**Manual fixes take forever.** You need automation.

== The Solution: GrimRepo Ecosystem

The GrimRepo ecosystem provides a complete workflow:

[source]
----
1. Audit             â†’ grim-repo (CLI)
2. Fix               â†’ GrimTemplateEngine (Community health files)
3. Validate License  â†’ GrimLicenseChecker (SPDX compliance)
4. Check CI/CD       â†’ GrimCIValidator (Workflow quality)
5. Scan Security     â†’ GrimSecurityScanner (Vulnerability detection)
6. Build             â†’ GrimGreaser (Build system)
7. Browse            â†’ GrimPager (Auto-paging)
----

== Step-by-Step Guide

=== Phase 1: Audit Your Repositories

**Tool**: `grim-repo` (standalone toolkit)

[source,bash]
----
# Clone the audit toolkit
git clone https://github.com/hyperpolymath/grim-repo
cd grim-repo

# Scan a single repo
./grim-audit ~/repos/my-project

# Scan all repos
for repo in ~/repos/*; do
  ./grim-audit "$repo"
done > audit-report.txt
----

**Output Example:**
[source]
----
Repo: my-project
âŒ Missing: LICENSE
âŒ Missing: SECURITY.md
âŒ Missing: CODE_OF_CONDUCT.md
âœ“ Has: README.md
âœ“ Has: CONTRIBUTING.md

Score: 40/100
----

=== Phase 2: Fix Issues Automatically

**Tool**: `GrimTemplateEngine` (browser userscript)

**Install**:
1. Install Tampermonkey
2. Load `dist/GrimTemplateEngine.user.js`
3. Visit any GitHub/GitLab repo

**What It Does**:
- Detects missing files
- Shows floating panel with health score
- Generates customized templates
- Pre-fills GitHub editor with one click

**Example Workflow**:
[source]
----
1. Visit github.com/hyperpolymath/my-repo
   â†“
2. Panel appears: "Health Score: 40/100"
   â†“
3. Shows:
   [ğŸ”´ Critical]
   LICENSE ............... [Create]
   SECURITY.md ........... [Create]

   [ğŸŸ  Important]
   CHANGELOG.md .......... [Create]
   â†“
4. Click "Create" â†’ Opens GitHub editor
   â†“
5. Content already filled:
   # Security Policy

   Email: security@hyperpolymath.dev

   (customized with your owner name!)
   â†“
6. Click "Commit" â†’ Done!
----

=== Phase 2b: License Compliance Check

**Tool**: `GrimLicenseChecker` (browser userscript)

**What It Does**:
- Scans source files for SPDX headers
- Detects license inconsistencies
- Shows compliance percentage
- Highlights files missing headers

**Example Workflow**:
[source]
----
1. Visit github.com/hyperpolymath/my-repo
   â†“
2. Panel appears: "License Compliance"
   Files Scanned: 50
   With SPDX Headers: 35
   Missing Headers: 15
   Compliance Rate: 70%
   â†“
3. Shows file list with status indicators:
   âœ… index.res - PMPL-1.0-or-later
   âŒ utils.res - Missing header
   âŒ config.res - Missing header
   â†“
4. Add missing headers manually or via template
----

**Compliance Goals**:
- ğŸŸ¢ 95%+ = Excellent
- ğŸŸ¡ 70-94% = Good
- ğŸ”´ <70% = Needs work

=== Phase 2c: CI/CD Quality Validation

**Tool**: `GrimCIValidator` (browser userscript)

**What It Does**:
- Validates GitHub Actions workflows
- Detects unpinned actions
- Checks for permissions declarations
- Finds hardcoded secrets
- Scores workflow quality (0-100)

**Example Workflow**:
[source]
----
1. Visit github.com/hyperpolymath/my-repo/.github/workflows/ci.yml
   â†“
2. Panel appears: "CI/CD Quality Check"
   Workflow Score: 65/100
   â†“
3. Shows issues:
   âŒ [Critical] Unpinned action: actions/checkout@v4
       â†’ Fix: Pin to SHA: actions/checkout@SHA # v4
   âŒ [Critical] Missing permissions declaration
       â†’ Fix: Add 'permissions: read-all' at workflow level
   âš ï¸  [Warning] Missing SPDX-License-Identifier header
       â†’ Fix: Add '# SPDX-License-Identifier: PMPL-1.0-or-later' as first line
   â†“
4. Apply fixes to achieve 90+ score
----

**Score Interpretation**:
- 80-100 = Well-secured workflow
- 50-79 = Needs improvements
- 0-49 = Critical issues present

=== Phase 2d: Security Scanning

**Tool**: `GrimSecurityScanner` (browser userscript)

**What It Does**:
- Detects hardcoded secrets and API keys
- Finds dangerous code patterns
- Checks for missing security files
- Calculates risk score

**Example Workflow**:
[source]
----
1. Visit github.com/hyperpolymath/my-repo
   â†“
2. Click "Run Security Scan" from userscript menu
   â†“
3. Panel appears: "Security Scan"
   Risk Score: 25
   High: 0 | Medium: 2 | Low: 1
   â†“
4. Shows issues:
   âš ï¸  [Medium] Missing File: No SECURITY.md file
       â†’ Add SECURITY.md with vulnerability reporting instructions
   âš ï¸  [Medium] Dangerous Pattern: Use of eval()
       â†’ Review usage and consider safer alternatives
   ğŸ”µ  [Low] Missing File: No CODE_OF_CONDUCT.md file
       â†’ Add CODE_OF_CONDUCT.md to set community standards
   â†“
5. Address high/medium severity issues first
----

**Risk Score Interpretation**:
- 0-20 = Low risk
- 20-50 = Medium risk
- 50+ = High risk

=== Phase 3: Batch Processing Strategy

**For 100+ repos:**

==== Option A: Manual Browser Workflow

[source,bash]
----
# Generate list of repos
gh repo list hyperpolymath --limit 1000 --json url --jq '.[].url' > repos.txt

# Visit each in browser (GrimTemplateEngine auto-activates)
while read url; do
  echo "Opening $url"
  open "$url"  # macOS
  # google-chrome "$url"  # Linux
  sleep 5  # Give time to review
done < repos.txt
----

==== Option B: GitHub API (Requires Token)

**Future Enhancement** (not yet implemented):

[source,bash]
----
# Batch create files via API
./grim-fix-all \
  --repos repos.txt \
  --token $GITHUB_TOKEN \
  --files LICENSE,SECURITY.md,CODE_OF_CONDUCT.md

# Dry run first
./grim-fix-all --repos repos.txt --dry-run
----

=== Phase 4: Continuous Monitoring

==== GitHub Actions Workflow

Add to each repo:

[source,yaml]
----
# .github/workflows/repo-health.yml
name: Repository Health Check

on:
  schedule:
    - cron: '0 0 * * 0'  # Weekly
  workflow_dispatch:

jobs:
  health-check:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Check Standards
        run: |
          # Check for required files
          files="LICENSE SECURITY.md CODE_OF_CONDUCT.md CONTRIBUTING.md"
          missing=""

          for file in $files; do
            if [ ! -f "$file" ]; then
              missing="$missing $file"
            fi
          done

          if [ -n "$missing" ]; then
            echo "::warning::Missing files:$missing"
            exit 1
          else
            echo "âœ… All standards met"
          fi
----

==== Integration with grim-repo

[source,bash]
----
# In each repo's CI
- name: Audit Repository
  run: |
    curl -sSL https://raw.githubusercontent.com/hyperpolymath/grim-repo/main/install.sh | sh
    grim-audit .
----

== Priority System

Fix in this order:

=== ğŸ”´ Critical (Do First)

These have legal/security implications:

1. **LICENSE** - Without this, code is proprietary by default
2. **SECURITY.md** - Security researchers need contact info
3. **CODE_OF_CONDUCT.md** - Protects maintainers and community

**Time Investment**: ~10 minutes per repo

**GrimTemplate Helps**: Auto-generates all three with your info

=== ğŸŸ  Important (Do Next)

These improve contributor experience:

1. **CONTRIBUTING.md** - How to contribute
2. **CHANGELOG.md** - Version history
3. **AUTHORS.md** - Credit contributors

**Time Investment**: ~20 minutes per repo

**GrimTemplate Helps**: Pre-fills with repo name, links

=== ğŸ”µ Recommended (Nice to Have)

These add polish:

1. **CITATION.cff** - Academic citations
2. **SUPPORT.md** - Getting help
3. **FUNDING.yml** - Sponsorship

**Time Investment**: ~5 minutes per repo

**GrimTemplate Helps**: Generates all with one click

== Quality Gates

=== Bronze Standard (50+ score)

Minimum viable:
- âœ… LICENSE
- âœ… README.md
- âœ… SECURITY.md

**Achievable**: 1 hour for 10 repos with GrimTemplate

=== Silver Standard (75+ score)

Production ready:
- âœ… Bronze +
- âœ… CODE_OF_CONDUCT.md
- âœ… CONTRIBUTING.md
- âœ… CHANGELOG.md

**Achievable**: 2 hours for 10 repos with GrimTemplate

=== Gold Standard (90+ score)

OpenSSF Best Practices:
- âœ… Silver +
- âœ… AUTHORS.md
- âœ… CITATION.cff
- âœ… SUPPORT.md
- âœ… Automated CI

**Achievable**: 3 hours for 10 repos with automation

== Maintenance Strategy

=== Template Updates

When standards evolve:

[source,bash]
----
# Update GrimTemplate
cd grimrepo-scripts
git pull origin main

# Rebuild userscript
deno task build

# Reinstall in browser
# (Or use auto-update if published to GreasyFork)
----

=== Propagating Changes

**Scenario**: You want to update SECURITY.md across all repos

**Solution A**: Manual (Small Scale)
[source,bash]
----
# Visit each repo, GrimTemplate detects outdated files
# Click "Update" button (future feature)
----

**Solution B**: Automation (Large Scale)
[source,bash]
----
# Using GitHub CLI
for repo in $(gh repo list --limit 1000 --json name --jq '.[].name'); do
  gh api repos/hyperpolymath/$repo/contents/SECURITY.md \
    --method PUT \
    --field message="Update security policy" \
    --field content=$(base64 < new-security.md)
done
----

== Measuring Progress

=== Health Score Tracking

[source,bash]
----
# Generate score report
cd grimrepo-scripts
deno run scripts/score-all-repos.ts > scores.csv

# Result:
Repo,Score,Critical,Important,Recommended
my-repo,85,0,1,2
another-repo,40,2,3,4
...
----

=== Visualization

Create a dashboard:

[source,html]
----
Repo Health Dashboard
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸŸ¢ Gold (90+):    45 repos
ğŸŸ¡ Silver (75+):  32 repos
ğŸŸ  Bronze (50+):  18 repos
ğŸ”´ Needs Work:    5 repos

Overall Average: 78/100
----

== Common Pitfalls

=== Pitfall 1: Copy-Paste Without Customization

**Problem**: Copying generic templates loses context

**Solution**: Use GrimTemplate for auto-customization
[source]
----
Bad:  Email: security@example.com
Good: Email: security@hyperpolymath.dev
----

=== Pitfall 2: Inconsistent Formatting

**Problem**: CONTRIBUTING.md differs across repos

**Solution**: Use template system, update once, propagate

=== Pitfall 3: Outdated Information

**Problem**: Email addresses change, links break

**Solution**: Centralize templates, version them
[source,bash]
----
grimrepo-scripts/
â””â”€â”€ templates/
    â”œâ”€â”€ v1.0/
    â”‚   â””â”€â”€ SECURITY.md
    â””â”€â”€ v2.0/
        â””â”€â”€ SECURITY.md (updated)
----

=== Pitfall 4: No Verification

**Problem**: Files exist but are incomplete

**Solution**: Add linting
[source,bash]
----
# Check SECURITY.md has contact email
if ! grep -q "@" SECURITY.md; then
  echo "SECURITY.md missing email"
fi
----

== Advanced Techniques

=== Technique 1: Mono-Repo Health

**Challenge**: One repo, multiple projects

**Solution**: Per-project standards
[source]
----
monorepo/
â”œâ”€â”€ SECURITY.md      # Root level
â”œâ”€â”€ project-a/
â”‚   â”œâ”€â”€ CONTRIBUTING.md
â”‚   â””â”€â”€ AUTHORS.md
â””â”€â”€ project-b/
    â”œâ”€â”€ CONTRIBUTING.md
    â””â”€â”€ AUTHORS.md
----

=== Technique 2: Template Inheritance

**Concept**: Base template + customizations

[source,rescript]
----
let securityBase = (info) => `# Security Policy...`

let securityWithBugBounty = (info) => {
  securityBase(info) ++ `

## Bug Bounty

We offer rewards for critical vulnerabilities.
`
}
----

=== Technique 3: Multi-Language Support

**Challenge**: International contributors

**Solution**: Generate templates in multiple languages

[source,rescript]
----
type language = EN | ES | FR | DE

let contributing = (info, lang) => {
  switch lang {
  | EN => "# Contributing..."
  | ES => "# Contribuyendo..."
  | FR => "# Contribuer..."
  | DE => "# Mitwirken..."
  }
}
----

== ROI Calculation

=== Time Savings

**Manual Method**:
- 30 min/repo Ã— 100 repos = **50 hours**

**With GrimTemplate**:
- 5 min/repo Ã— 100 repos = **8 hours**

**Savings**: 42 hours (84% reduction)

=== Quality Improvement

**Before**:
- Average score: 40/100
- Critical files: 30% coverage

**After**:
- Average score: 85/100
- Critical files: 100% coverage

=== Risk Reduction

**Without LICENSE**:
- Legal ambiguity
- Cannot use in production

**Without SECURITY.md**:
- Vulnerabilities unreported
- Public disclosure

**Value**: Immeasurable (compliance + security)

== Conclusion

Getting repositories under control requires:

1. **Audit** - Know what's missing (grim-repo)
2. **Fix** - Add missing files (GrimTemplate)
3. **Automate** - CI checks (GitHub Actions)
4. **Monitor** - Track scores over time
5. **Maintain** - Update templates as standards evolve

**Start Today**:
[source,bash]
----
# Install GrimTemplate
cd grimrepo-scripts
deno task build

# Visit your worst repo
# Let GrimTemplate guide you to 100/100

# Then scale to all repos
----

---

*You've got this! ğŸš€*
